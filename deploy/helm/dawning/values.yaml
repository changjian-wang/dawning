# =============================================
# Dawning Gateway - Helm Values (默认配置)
# =============================================

# 全局配置
global:
  namespace: dawning
  imageRegistry: ""
  imagePullSecrets: []
  environment: production

# ===== Identity API 服务 =====
identityApi:
  enabled: true
  name: identity-api
  replicaCount: 2
  
  image:
    repository: aluneth/dawning-identity-api
    tag: "latest"
    pullPolicy: Always
  
  service:
    type: ClusterIP
    port: 5001
  
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 512Mi
  
  autoscaling:
    enabled: false
    minReplicas: 2
    maxReplicas: 10
    targetCPUUtilization: 80
  
  env:
    ASPNETCORE_ENVIRONMENT: Production
    ASPNETCORE_URLS: "http://+:5001"
  
  # 健康检查
  livenessProbe:
    httpGet:
      path: /health
      port: 5001
    initialDelaySeconds: 15
    periodSeconds: 30
  
  readinessProbe:
    httpGet:
      path: /health
      port: 5001
    initialDelaySeconds: 10
    periodSeconds: 10

# ===== Gateway API 服务 =====
gatewayApi:
  enabled: true
  name: gateway-api
  replicaCount: 2
  
  image:
    repository: aluneth/dawning-gateway-api
    tag: "latest"
    pullPolicy: Always
  
  service:
    type: ClusterIP
    port: 5000
  
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 512Mi
  
  autoscaling:
    enabled: false
    minReplicas: 2
    maxReplicas: 10
    targetCPUUtilization: 80
  
  env:
    ASPNETCORE_ENVIRONMENT: Production
    ASPNETCORE_URLS: "http://+:5000"
  
  livenessProbe:
    httpGet:
      path: /health
      port: 5000
    initialDelaySeconds: 15
    periodSeconds: 30
  
  readinessProbe:
    httpGet:
      path: /health
      port: 5000
    initialDelaySeconds: 10
    periodSeconds: 10

# ===== Admin Frontend 前端 =====
adminFrontend:
  enabled: true
  name: admin-frontend
  replicaCount: 2
  
  image:
    repository: aluneth/dawning-admin-frontend
    tag: "latest"
    pullPolicy: IfNotPresent
  
  service:
    type: ClusterIP
    port: 80
  
  resources:
    requests:
      cpu: 50m
      memory: 64Mi
    limits:
      cpu: 200m
      memory: 128Mi
  
  livenessProbe:
    httpGet:
      path: /
      port: 80
    initialDelaySeconds: 10
    periodSeconds: 30
  
  readinessProbe:
    httpGet:
      path: /
      port: 80
    initialDelaySeconds: 5
    periodSeconds: 10

# ===== Ingress 配置 =====
ingress:
  enabled: true
  className: nginx
  annotations:
    nginx.ingress.kubernetes.io/proxy-body-size: "50m"
    nginx.ingress.kubernetes.io/proxy-read-timeout: "300"
    nginx.ingress.kubernetes.io/proxy-send-timeout: "300"
  
  hosts:
    - host: localhost
      paths:
        - path: /
          pathType: Prefix
          service: admin-frontend
        - path: /api
          pathType: Prefix
          service: identity-api
        - path: /gateway
          pathType: Prefix
          service: gateway-api
  
  tls: []
  # - secretName: dawning-tls
  #   hosts:
  #     - dawning.example.com

# ===== 数据库配置 =====
database:
  # 外部数据库（生产推荐）
  external:
    enabled: false
    host: ""
    port: 3306
    database: dawning_identity
    username: ""
    password: ""
  
  # 使用内置 MySQL（开发/测试）
  internal:
    enabled: true

# ===== Redis 配置 =====
cache:
  external:
    enabled: false
    host: ""
    port: 6379
    password: ""
  
  internal:
    enabled: true

# ===== Kafka 配置 =====
messaging:
  enabled: true
  external:
    enabled: false
    bootstrapServers: ""
  
  internal:
    enabled: true

# ===== Bitnami MySQL 子 Chart 配置 =====
mysql:
  enabled: true
  auth:
    rootPassword: "dawning_root_2024"
    database: "dawning_identity"
    username: "dawning"
    password: "dawning_password_2024"
  primary:
    persistence:
      enabled: true
      size: 10Gi

# ===== Bitnami Redis 子 Chart 配置 =====
redis:
  enabled: true
  auth:
    enabled: false
  master:
    persistence:
      enabled: true
      size: 2Gi

# ===== Bitnami Kafka 子 Chart 配置 =====
kafka:
  enabled: true
  listeners:
    client:
      protocol: PLAINTEXT
    interbroker:
      protocol: PLAINTEXT
  controller:
    replicaCount: 1
  persistence:
    enabled: true
    size: 10Gi

# ===== ConfigMap 数据 =====
configMap:
  data: {}

# ===== Secrets =====
secrets:
  # 如果为空，将自动生成
  jwtSecret: ""
  openIddictKey: ""

# ===== 证书配置 =====
certificates:
  enabled: true
  # 证书密码
  password: "DawningCert@2024"
